<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Miss√£o ENEM: Decole nos Estudos!</title>
    <!-- Chosen Palette: Cosmic Neon (#0D0D2B background, #3B82F6 accent, #A78BFA secondary, #EC4899 highlight) -->
    <!-- Application Structure Plan: A gamified, single-page application (SPA) with a space exploration theme. The main page is a "galaxy" of subject areas (Linguagens, Humanas, etc.). Clicking an area reveals its "planets" (subjects). Clicking a subject opens a modal "mission brief" listing the most frequent topics, each with a link to a curated video lesson. This structure is designed to be engaging, reduce overwhelm by focusing on one subject at a time, and provide a clear, centered path for study. -->
    <!-- Visualization & Content Choices: The core interactive element is the modal window. Report Info: List of top ENEM topics per subject -> Goal: Organize/Inform -> Presentation Method: Modal with an accordion list -> Interaction: Click subject to open modal, click topic to expand and reveal video link -> Justification: Keeps the main interface clean while providing deep, focused content on demand. The accordion prevents the topic list from being too long initially. Library: Vanilla JS, Tailwind CSS. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Space Grotesk', sans-serif;
            background-color: #0D0D2B;
            background-image: url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40"%3E%3Cg fill-rule="evenodd"%3E%3Cg fill="%239C92AC" fill-opacity="0.1"%3E%3Cpath d="M0 38.59l2.83-2.83 1.41 1.41L1.41 40H0v-1.41zM0 1.4l2.83 2.83 1.41-1.41L1.41 0H0v1.41zM38.59 40l-2.83-2.83 1.41-1.41L40 38.59V40h-1.41zM40 1.41l-2.83 2.83-1.41-1.41L38.59 0H40v1.41z"/%3E%3C/g%3E%3C/g%3E%3C/svg%3E');
        }
        .subject-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid #3B82F640;
        }
        .subject-card:hover {
            transform: translateY(-10px) scale(1.03);
            box-shadow: 0 0 25px #3B82F680;
        }
        .modal {
            transition: opacity 0.3s ease;
        }
        .modal-content {
            transition: transform 0.3s ease;
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s cubic-bezier(0.25, 0.1, 0.25, 1.0);
        }
        .topic-item.completed {
            background-color: rgba(59, 130, 246, 0.1);
        }
        .form-checkbox {
            appearance: none;
            padding: 0;
            color-adjust: exact;
            display: inline-block;
            vertical-align: middle;
            background-origin: border-box;
            user-select: none;
            flex-shrink: 0;
            height: 1.25rem;
            width: 1.25rem;
            border-radius: 0.25rem;
            background-color: #1E1E3F;
            border: 2px solid #3B82F6;
            margin-right: 0.5rem;
        }
        .form-checkbox:checked {
            background-color: #3B82F6;
            border-color: #3B82F6;
            background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3c/svg%3e");
        }
        .form-checkbox:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.5);
        }
        .quiz-option {
            appearance: none;
            width: 1.2rem;
            height: 1.2rem;
            border: 2px solid #3B82F6;
            border-radius: 50%;
            margin-right: 0.5rem;
            position: relative;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .quiz-option:checked {
            background-color: #3B82F6;
            border-color: #3B82F6;
        }
        .quiz-option:checked::after {
            content: '';
            position: absolute;
            width: 0.5rem;
            height: 0.5rem;
            background-color: white;
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        .quiz-question {
            transition: all 0.3s ease;
        }
        .quiz-question:hover {
            transform: translateX(5px);
        }
        .quiz-feedback {
            transition: all 0.3s ease;
        }
    </style>
</head>
<body class="text-white">

    <!-- Header -->
    <header class="text-center py-12 px-4">
        <h1 class="text-4xl md:text-6xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 via-purple-400 to-pink-500 mb-2">
            Miss√£o ENEM
        </h1>
        <p class="text-lg md:text-xl text-gray-300 max-w-2xl mx-auto">Sua plataforma de lan√ßamento para a aprova√ß√£o. Explore os planetas do conhecimento!</p>
    </header>

    <!-- Main Content -->
    <main id="subject-galaxy" class="container mx-auto px-4 py-8">
        <!-- Content will be generated by JS -->
    </main>
    
    <!-- Footer -->
    <footer class="text-center py-8 mt-12 border-t border-blue-900/50">
        <p class="text-gray-400">Desenvolvido para impulsionar seus estudos. Boa sorte, astronauta!</p>
    </footer>

    <!-- Modal -->
    <div id="topic-modal" class="modal fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 z-50 opacity-0 pointer-events-none">
        <div id="modal-content" class="modal-content bg-[#1E1E3F] rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col transform scale-95">
            <header class="p-6 flex justify-between items-center border-b border-blue-900/50 flex-shrink-0">
                <h2 id="modal-title" class="text-2xl font-bold">T√≥picos da Miss√£o</h2>
                <button onclick="closeModal()" class="text-gray-400 hover:text-white transition-colors text-3xl">&times;</button>
            </header>
            <div id="modal-body" class="p-6 overflow-y-auto">
                <!-- Accordion items will be generated here -->
            </div>
        </div>
    </div>

<script>
const missionDatabase = {
    linguagens: {
        title: "Linguagens, C√≥digos e suas Tecnologias",
        color: "pink",
        subjects: [
            { name: "Portugu√™s", icon: "üìö", topics: [
                { 
                    title: "Interpreta√ß√£o de Texto", 
                    link: "https://www.youtube.com/watch?v=O0TTbXCTg-I",
                    summary: `‚Ä¢ Identifica√ß√£o da ideia central do texto
‚Ä¢ Reconhecimento de informa√ß√µes expl√≠citas e impl√≠citas
‚Ä¢ An√°lise de recursos argumentativos
‚Ä¢ Rela√ß√µes de causa e consequ√™ncia
‚Ä¢ Identifica√ß√£o do p√∫blico-alvo e objetivo do texto`,
                    quiz: [
                        {
                            question: "Qual √© o principal objetivo da interpreta√ß√£o textual?",
                            options: [
                                "Apenas identificar palavras dif√≠ceis",
                                "Compreender o significado global e as nuances do texto",
                                "Memorizar o texto inteiro",
                                "Contar o n√∫mero de par√°grafos"
                            ],
                            correct: 1
                        },
                        {
                            question: "O que s√£o informa√ß√µes impl√≠citas em um texto?",
                            options: [
                                "Informa√ß√µes que est√£o claramente escritas",
                                "Informa√ß√µes que podem ser deduzidas do texto",
                                "Apenas as palavras dif√≠ceis",
                                "O t√≠tulo do texto"
                            ],
                            correct: 1
                        }
                    ]
                },
                { 
                    title: "Estrutura e G√™neros Textuais", 
                    link: "https://www.youtube.com/watch?v=W3XrpIRTgzA",
                    summary: `‚Ä¢ Caracter√≠sticas dos diferentes g√™neros textuais
‚Ä¢ Elementos estruturais de cada g√™nero
‚Ä¢ Adequa√ß√£o da linguagem ao g√™nero
‚Ä¢ Contexto de produ√ß√£o e circula√ß√£o
‚Ä¢ Fun√ß√µes sociais dos g√™neros textuais`,
                    quiz: [
                        {
                            question: "O que caracteriza um texto dissertativo-argumentativo?",
                            options: [
                                "Apenas narrar uma hist√≥ria",
                                "Apresentar argumentos para defender um ponto de vista",
                                "Descrever uma paisagem",
                                "Fazer um di√°logo entre personagens"
                            ],
                            correct: 1
                        }
                    ]
                },
                { 
                    title: "Varia√ß√£o Lingu√≠stica", 
                    link: "https://www.youtube.com/watch?v=Aqh32VzKvqo",
                    summary: `‚Ä¢ Tipos de varia√ß√£o lingu√≠stica
‚Ä¢ Fatores que influenciam a varia√ß√£o
‚Ä¢ Preconceito lingu√≠stico
‚Ä¢ Norma culta e variedades
‚Ä¢ Adequa√ß√£o lingu√≠stica`,
                    quiz: [
                        {
                            question: "O que √© varia√ß√£o lingu√≠stica?",
                            options: [
                                "Erros de portugu√™s",
                                "Diferentes formas de usar a l√≠ngua",
                                "Apenas g√≠rias",
                                "Linguagem da internet"
                            ],
                            correct: 1
                        }
                    ]
                },
                { 
                    title: "Fun√ß√µes da Linguagem", 
                    link: "https://www.youtube.com/watch?v=d6kS7zj8p2Q",
                    summary: `‚Ä¢ Fun√ß√£o referencial
‚Ä¢ Fun√ß√£o emotiva
‚Ä¢ Fun√ß√£o conativa
‚Ä¢ Fun√ß√£o po√©tica
‚Ä¢ Fun√ß√£o f√°tica
‚Ä¢ Fun√ß√£o metalingu√≠stica`,
                    quiz: [
                        {
                            question: "Qual fun√ß√£o da linguagem predomina em um poema?",
                            options: [
                                "Fun√ß√£o referencial",
                                "Fun√ß√£o po√©tica",
                                "Fun√ß√£o f√°tica",
                                "Fun√ß√£o metalingu√≠stica"
                            ],
                            correct: 1
                        }
                    ]
                }
            ]},
            { name: "Literatura", icon: "üñãÔ∏è", topics: [
                { 
                    title: "Modernismo", 
                    link: "https://www.youtube.com/watch?v=NP3y5JVJ--I",
                    summary: `‚Ä¢ Primeira fase do modernismo (1922-1930)
‚Ä¢ Segunda fase do modernismo (1930-1945)
‚Ä¢ Terceira fase do modernismo (1945-1980)
‚Ä¢ Principais autores e obras
‚Ä¢ Caracter√≠sticas de cada fase`,
                    quiz: [
                        {
                            question: "Qual evento marca o in√≠cio do Modernismo no Brasil?",
                            options: [
                                "Publica√ß√£o de 'Dom Casmurro'",
                                "Semana de Arte Moderna de 1922",
                                "Proclama√ß√£o da Rep√∫blica",
                                "Independ√™ncia do Brasil"
                            ],
                            correct: 1
                        }
                    ]
                },
                { 
                    title: "Romantismo", 
                    link: "https://www.youtube.com/watch?v=Cc7Ou-FlcUo",
                    summary: `‚Ä¢ Contexto hist√≥rico
‚Ä¢ Caracter√≠sticas do movimento
‚Ä¢ As tr√™s gera√ß√µes rom√¢nticas
‚Ä¢ Principais autores e obras
‚Ä¢ Temas recorrentes`,
                    quiz: [
                        {
                            question: "Qual caracter√≠stica √© t√≠pica do Romantismo?",
                            options: [
                                "Objetividade",
                                "Idealiza√ß√£o e subjetividade",
                                "Racionalismo",
                                "Realismo"
                            ],
                            correct: 1
                        }
                    ]
                }
            ]},
            { name: "L√≠ngua Estrangeira", icon: "üåç", topics: [
                { title: "Interpreta√ß√£o de Texto (Ingl√™s)", link: "https://www.youtube.com/watch?v=O1fCg_8a-cE" },
                { title: "Interpreta√ß√£o de Texto (Espanhol)", link: "https://www.youtube.com/watch?v=XWp1y7gS2_Q" },
            ]},
            { name: "Artes", icon: "üé®", topics: [
                { title: "Arte Contempor√¢nea", link: "https://www.youtube.com/watch?v=cMUmphZd4_U" },
                { title: "Vanguardas Europeias", link: "https://www.youtube.com/watch?v=Lq1h7L2XqL8" },
                { title: "Modernismo no Brasil", link: "https://www.youtube.com/watch?v=3sS-H7wSn1k" },
            ]},
        ],
    },
    humanas: {
        title: "Ci√™ncias Humanas e suas Tecnologias",
        color: "purple",
        subjects: [
            { name: "Hist√≥ria", icon: "‚è≥", topics: [
                { 
                    title: "Brasil Col√¥nia e Imp√©rio", 
                    link: "https://www.youtube.com/watch?v=q7E4XrfGGnE",
                    summary: `‚Ä¢ Per√≠odo Colonial (1500-1822)
‚Ä¢ Processo de Independ√™ncia
‚Ä¢ Primeiro e Segundo Reinado
‚Ä¢ Economia e Sociedade
‚Ä¢ Fim do Imp√©rio`,
                    quiz: [
                        {
                            question: "Qual foi o principal fator que levou √† independ√™ncia do Brasil?",
                            options: [
                                "Revolu√ß√£o Industrial",
                                "Vinda da Fam√≠lia Real",
                                "Guerra dos Emboabas",
                                "Descoberta do ouro"
                            ],
                            correct: 1
                        }
                    ]
                },
                { 
                    title: "Era Vargas e Rep√∫blica", 
                    link: "https://www.youtube.com/watch?v=093NZjlOgkQ",
                    summary: `‚Ä¢ Rep√∫blica Velha
‚Ä¢ Revolu√ß√£o de 1930
‚Ä¢ Estado Novo
‚Ä¢ Redemocratiza√ß√£o
‚Ä¢ Ditadura Militar`,
                    quiz: [
                        {
                            question: "Qual caracter√≠stica marca o Estado Novo?",
                            options: [
                                "Democracia plena",
                                "Centraliza√ß√£o do poder",
                                "Liberalismo econ√¥mico",
                                "Pluripartidarismo"
                            ],
                            correct: 1
                        }
                    ]
                }
            ]},
            { name: "Geografia", icon: "üó∫Ô∏è", topics: [
                { 
                    title: "Globaliza√ß√£o e Nova Ordem Mundial", 
                    link: "https://www.youtube.com/watch?v=0Kcrms9olwo",
                    summary: `‚Ä¢ Conceito de Globaliza√ß√£o
‚Ä¢ Blocos Econ√¥micos
‚Ä¢ Geopol√≠tica Mundial
‚Ä¢ Conflitos Internacionais
‚Ä¢ Organiza√ß√µes Internacionais`,
                    quiz: [
                        {
                            question: "O que caracteriza a globaliza√ß√£o?",
                            options: [
                                "Isolamento entre pa√≠ses",
                                "Integra√ß√£o mundial",
                                "Economia fechada",
                                "Aus√™ncia de tecnologia"
                            ],
                            correct: 1
                        }
                    ]
                }
            ]},
            { name: "Filosofia", icon: "ü§î", topics: [
                { 
                    title: "√âtica e Moral", 
                    link: "https://www.youtube.com/watch?v=-pAQS5Aqo88",
                    summary: `‚Ä¢ Conceitos de √âtica e Moral
‚Ä¢ Valores e Princ√≠pios
‚Ä¢ Liberdade e Responsabilidade
‚Ä¢ Teorias √âticas
‚Ä¢ Dilemas Morais`,
                    quiz: [
                        {
                            question: "Qual a diferen√ßa entre √©tica e moral?",
                            options: [
                                "S√£o a mesma coisa",
                                "√âtica √© reflex√£o sobre moral",
                                "Moral √© mais importante",
                                "√âtica n√£o existe"
                            ],
                            correct: 1
                        }
                    ]
                }
            ]}
        ]
    },
    natureza: {
        title: "Ci√™ncias da Natureza e suas Tecnologias",
        color: "blue",
        subjects: [
            { name: "Biologia", icon: "üåø", topics: [
                { 
                    title: "Bioenerg√©tica", 
                    link: "https://www.youtube.com/watch?v=yJzcFQ8nCLw",
                    summary: `‚Ä¢ Fotoss√≠ntese
‚Ä¢ Respira√ß√£o Celular
‚Ä¢ Fermenta√ß√£o
‚Ä¢ Metabolismo Energ√©tico
‚Ä¢ Ciclo do ATP`,
                    quiz: [
                        {
                            question: "Qual √© o principal produto da fotoss√≠ntese?",
                            options: [
                                "√Ågua",
                                "Glicose",
                                "G√°s carb√¥nico",
                                "Oxig√™nio"
                            ],
                            correct: 1
                        }
                    ]
                }
            ]},
            { name: "F√≠sica", icon: "‚öõÔ∏è", topics: [
                { 
                    title: "Mec√¢nica e Energia", 
                    link: "https://www.youtube.com/watch?v=92jATObdgEg",
                    summary: `‚Ä¢ Leis de Newton
‚Ä¢ Energia Cin√©tica e Potencial
‚Ä¢ Trabalho e Pot√™ncia
‚Ä¢ Conserva√ß√£o de Energia
‚Ä¢ Impulso e Quantidade de Movimento`,
                    quiz: [
                        {
                            question: "O que √© energia potencial gravitacional?",
                            options: [
                                "Energia do movimento",
                                "Energia da posi√ß√£o",
                                "Energia do calor",
                                "Energia el√©trica"
                            ],
                            correct: 1
                        }
                    ]
                }
            ]},
            { name: "Qu√≠mica", icon: "üß™", topics: [
                { 
                    title: "Estrutura At√¥mica", 
                    link: "https://www.youtube.com/watch?v=JRKAhefJ0zw",
                    summary: `‚Ä¢ Modelos At√¥micos
‚Ä¢ Part√≠culas Subat√¥micas
‚Ä¢ Distribui√ß√£o Eletr√¥nica
‚Ä¢ N√∫meros Qu√¢nticos
‚Ä¢ Propriedades Peri√≥dicas`,
                    quiz: [
                        {
                            question: "Qual part√≠cula tem carga negativa?",
                            options: [
                                "Pr√≥ton",
                                "El√©tron",
                                "N√™utron",
                                "N√∫cleo"
                            ],
                            correct: 1
                        }
                    ]
                }
            ]}
        ]
    },
    matematica: {
        title: "Matem√°tica e suas Tecnologias",
        color: "teal",
        subjects: [
            { name: "Matem√°tica", icon: "üî¢", topics: [
                { 
                    title: "Fun√ß√µes", 
                    link: "https://www.youtube.com/watch?v=4q2N2HzSivA",
                    summary: `‚Ä¢ Fun√ß√£o do 1¬∫ Grau
‚Ä¢ Fun√ß√£o do 2¬∫ Grau
‚Ä¢ Fun√ß√£o Exponencial
‚Ä¢ Fun√ß√£o Logar√≠tmica
‚Ä¢ Gr√°ficos e Aplica√ß√µes`,
                    quiz: [
                        {
                            question: "O que √© uma fun√ß√£o do 1¬∫ grau?",
                            options: [
                                "Uma equa√ß√£o quadr√°tica",
                                "Uma rela√ß√£o linear",
                                "Uma fun√ß√£o trigonom√©trica",
                                "Uma progress√£o geom√©trica"
                            ],
                            correct: 1
                        }
                    ]
                },
                { 
                    title: "Geometria", 
                    link: "https://www.youtube.com/watch?v=EieOYCmWHHM",
                    summary: `‚Ä¢ Geometria Plana
‚Ä¢ Geometria Espacial
‚Ä¢ Trigonometria
‚Ä¢ √Åreas e Volumes
‚Ä¢ Semelhan√ßa e Congru√™ncia`,
                    quiz: [
                        {
                            question: "Como calcular a √°rea de um tri√¢ngulo?",
                            options: [
                                "Base x Altura",
                                "(Base x Altura)/2",
                                "Base + Altura",
                                "Base¬≤ + Altura¬≤"
                            ],
                            correct: 1
                        }
                    ]
                }
            ]}
        ]
    }
};

const colors = {
    pink: { border: 'border-pink-500/50', hover: 'hover:border-pink-500', shadow: 'hover:shadow-pink-500/30' },
    purple: { border: 'border-purple-500/50', hover: 'hover:border-purple-500', shadow: 'hover:shadow-purple-500/30' },
    blue: { border: 'border-blue-500/50', hover: 'hover:border-blue-500', shadow: 'hover:shadow-blue-500/30' },
    teal: { border: 'border-teal-500/50', hover: 'hover:border-teal-500', shadow: 'hover:shadow-teal-500/30' },
};

function generateGalaxy() {
    const galaxyContainer = document.getElementById('subject-galaxy');
    galaxyContainer.innerHTML = '';
    
    for (const areaKey in missionDatabase) {
        const area = missionDatabase[areaKey];
        const areaColor = colors[area.color];

        const areaSection = document.createElement('div');
        areaSection.className = 'mb-16';
        areaSection.innerHTML = `
            <h2 class="text-3xl font-bold text-center mb-2">${area.title}</h2>
            <div class="w-24 h-1 bg-gradient-to-r from-${area.color}-500 to-${area.color}-400 mx-auto mb-8 rounded-full"></div>
            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8">
                ${area.subjects.map(subject => `
                    <div class="subject-card bg-[#1E1E3F]/60 backdrop-blur-sm p-6 rounded-xl text-center cursor-pointer ${areaColor.border} ${areaColor.hover} ${areaColor.shadow}"
                         onclick="showModal('${areaKey}', '${subject.name}')">
                        <div class="text-5xl mb-4">${subject.icon}</div>
                        <h3 class="text-xl font-bold">${subject.name}</h3>
                    </div>
                `).join('')}
            </div>
        `;
        galaxyContainer.appendChild(areaSection);
    }
}

async function toggleTopicCompletion(areaKey, subjectName, topicTitle, checkboxElement) {
    try {
        const endpoint = checkboxElement.checked ? '/api/progress/complete' : '/api/progress/uncomplete';
        const response = await fetch(endpoint, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                area: areaKey,
                subject: subjectName,
                topic: topicTitle
            })
        });

        if (!response.ok) {
            throw new Error('Falha ao atualizar progresso');
        }

        // Atualizar visual do t√≥pico
        const topicElement = checkboxElement.closest('.topic-item');
        topicElement.classList.toggle('completed', checkboxElement.checked);
    } catch (error) {
        console.error('Erro:', error);
        alert('Erro ao atualizar progresso. Tente novamente.');
        checkboxElement.checked = !checkboxElement.checked; // Reverter estado do checkbox
    }
}

async function loadTopicProgress(areaKey, subjectName, topicTitle) {
    try {
        const response = await fetch(`/api/progress?area=${encodeURIComponent(areaKey)}&subject=${encodeURIComponent(subjectName)}&topic=${encodeURIComponent(topicTitle)}`);
        if (!response.ok) throw new Error('Falha ao carregar progresso');
        return await response.json();
    } catch (error) {
        console.error('Erro ao carregar progresso:', error);
        return { completed: false };
    }
}

function showModal(areaKey, subjectName) {
    const area = missionDatabase[areaKey];
    const subject = area.subjects.find(s => s.name === subjectName);
    const modal = document.getElementById('topic-modal');
    const modalContent = document.getElementById('modal-content');
    const modalTitle = document.getElementById('modal-title');
    const modalBody = document.getElementById('modal-body');

    modalTitle.textContent = `Miss√£o: ${subject.name}`;
    
    modalBody.innerHTML = subject.topics.map((topic, index) => `
        <div class="topic-item border-b border-blue-900/30 last:border-b-0">
            <div class="flex items-center justify-between py-4 px-2">
                <button onclick="toggleAccordion(${index})" class="flex-grow flex items-center text-left hover:bg-blue-900/20 transition-colors rounded-lg pr-4">
                    <span class="font-semibold text-lg">${topic.title}</span>
                    <span id="arrow-${index}" class="ml-2 transform transition-transform duration-300 text-blue-400">‚ñ∂</span>
                </button>
                <label class="flex items-center space-x-2 cursor-pointer">
                    <input type="checkbox" 
                           class="form-checkbox h-5 w-5 text-blue-500 rounded border-gray-300 focus:ring-blue-500"
                           onchange="toggleTopicCompletion('${areaKey}', '${subjectName}', '${topic.title}', this)">
                    <span class="text-sm text-gray-400">Conclu√≠do</span>
                </label>
            </div>
            <div id="content-${index}" class="accordion-content px-2 pb-4">
                <!-- Resumo -->
                <div class="mb-6 bg-blue-900/20 p-4 rounded-lg">
                    <h4 class="font-bold text-blue-400 mb-2">üìù Resumo do Conte√∫do</h4>
                    <pre class="whitespace-pre-wrap text-gray-300 font-mono text-sm">${topic.summary || 'Resumo em breve...'}</pre>
                </div>

                <!-- Quiz -->
                <div class="mb-6">
                    <h4 class="font-bold text-blue-400 mb-4">üéØ Quiz R√°pido</h4>
                    ${topic.quiz ? topic.quiz.map((q, qIndex) => `
                        <div class="quiz-question mb-6 bg-purple-900/20 p-4 rounded-lg" data-correct="${q.correct}">
                            <p class="font-semibold mb-3">${q.question}</p>
                            <div class="space-y-2">
                                ${q.options.map((opt, optIndex) => `
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="radio" 
                                               name="quiz-${index}-${qIndex}" 
                                               value="${optIndex}"
                                               class="quiz-option"
                                               onchange="checkQuizAnswer(this)">
                                        <span>${opt}</span>
                                    </label>
                                `).join('')}
                            </div>
                            <div class="quiz-feedback mt-3 hidden"></div>
                        </div>
                    `).join('') : '<p class="text-gray-400">Quiz em breve...</p>'}
                </div>

                <!-- Link para a aula -->
                <a href="${topic.link}" target="_blank" rel="noopener noreferrer" 
                   class="inline-block bg-gradient-to-r from-${area.color}-500 to-${area.color}-600 text-white font-bold py-2 px-6 rounded-full hover:scale-105 transition-transform">
                    Assistir Aula üöÄ
                </a>
            </div>
        </div>
    `).join('');

    // Carregar estado de conclus√£o para cada t√≥pico
    subject.topics.forEach(async (topic) => {
        const progress = await loadTopicProgress(areaKey, subjectName, topic.title);
        const topicElement = modalBody.querySelector(`input[type="checkbox"][onchange*="${topic.title}"]`);
        if (topicElement) {
            topicElement.checked = progress.completed;
            const topicItem = topicElement.closest('.topic-item');
            if (progress.completed) {
                topicItem.classList.add('completed');
            }
        }
    });

    modal.classList.remove('opacity-0', 'pointer-events-none');
    modalContent.classList.remove('scale-95');
}

function closeModal() {
    const modal = document.getElementById('topic-modal');
    const modalContent = document.getElementById('modal-content');
    modal.classList.add('opacity-0', 'pointer-events-none');
    modalContent.classList.add('scale-95');
}

function toggleAccordion(index) {
    const content = document.getElementById(`content-${index}`);
    const arrow = document.getElementById(`arrow-${index}`);
    
    if (content.style.maxHeight) {
        content.style.maxHeight = null;
        arrow.style.transform = 'rotate(0deg)';
    } else {
        content.style.maxHeight = content.scrollHeight + "px";
        arrow.style.transform = 'rotate(90deg)';
    }
}

function checkQuizAnswer(radioElement) {
    const questionDiv = radioElement.closest('.quiz-question');
    const feedbackDiv = questionDiv.querySelector('.quiz-feedback');
    const correctAnswer = parseInt(questionDiv.dataset.correct);
    const selectedAnswer = parseInt(radioElement.value);

    feedbackDiv.classList.remove('hidden');
    
    if (selectedAnswer === correctAnswer) {
        feedbackDiv.innerHTML = `
            <div class="text-green-400 font-semibold">
                ‚úÖ Correto! Muito bem!
            </div>
        `;
    } else {
        feedbackDiv.innerHTML = `
            <div class="text-red-400 font-semibold">
                ‚ùå Ops! Tente novamente!
            </div>
        `;
    }
}

document.addEventListener('DOMContentLoaded', generateGalaxy);
</script>

</body>
</html>
